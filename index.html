<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Storage-wars by codinatrix</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Storage-wars</h1>
          <h2>Experiment med IndexedDB</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/codinatrix/storage-wars/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/codinatrix/storage-wars/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/codinatrix/storage-wars" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="indexeddb-och-application-cache-experiment-och-anteckningar" class="anchor" href="#indexeddb-och-application-cache-experiment-och-anteckningar" aria-hidden="true"><span class="octicon octicon-link"></span></a>IndexedDB och Application Cache experiment och anteckningar</h1>

<pre><code>$ cd your_repo_root/repo_name
$ git fetch origin
$ git checkout gh-pages
</code></pre>

<h2>
<a id="indexeddb" class="anchor" href="#indexeddb" aria-hidden="true"><span class="octicon octicon-link"></span></a>IndexedDB</h2>

<p>En databas som sitter på klientsidan i webbläsaren. Den gör offline läge möjligt och kan även användas för att göra online applikationer mycket snabbare. Den är i NoSQL stil, där man lagrar objekt istället för records eller rader. Den är transaktionsbaserad.</p>

<h3>
<a id="vad-finns-det-för-problem" class="anchor" href="#vad-finns-det-f%C3%B6r-problem" aria-hidden="true"><span class="octicon octicon-link"></span></a>Vad finns det för problem?</h3>

<p>API-en är inte samma på varje webbläsaren, och inte hellre samma på varje version av en webbläsare. Så det är svårt att använda IndexedDB för en cross-browser app och appen kan sluta fungera om användaren uppdaterar sin webbläsare. I skrivande stund funkar den inte på Safari, Opera, iOS, Opera Mobile eller Android Browser.</p>

<h3>
<a id="hur-söker-man-i-databasen" class="anchor" href="#hur-s%C3%B6ker-man-i-databasen" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hur söker man i databasen?</h3>

<p>IndexedDB kan själv inte sökas med den slags queries man använder i SQL, till exempel "Hitta alla objekt som matchar en visst set" eller "Hitta alla objekt som innehåller 'Sodra'" eller logiska OR eller AND.</p>

<h3>
<a id="vad-händer-om-en-databas-request-read-eller-write-misslyckas" class="anchor" href="#vad-h%C3%A4nder-om-en-databas-request-read-eller-write-misslyckas" aria-hidden="true"><span class="octicon octicon-link"></span></a>Vad händer om en databas request (read eller write) misslyckas?</h3>

<p>window.indexedDB.onerror() event triggers. Databasen rullas tillbaka och din Javascript kan hantera felet med en callback funktion till onerror() event. Du kan också avbryta en request (om det tar för lång tid till exempel) med en transaction.abort() metod, och den ska rullas tillbaka.</p>

<h3>
<a id="hur-bra-är-indexeddb-med-att-hantera-stora-mängder-data" class="anchor" href="#hur-bra-%C3%A4r-indexeddb-med-att-hantera-stora-m%C3%A4ngder-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hur bra är IndexedDB med att hantera stora mängder data?</h3>

<p>Det kan gå långsamt och eftersom Javascript är så klart single-threaded, hela appen kan hänga sig. Man kan förmodligen fixa concurrency med en Web Worker, men jag har inte testat just det ännu. Annars får man fixa en overlay med "Vi jobbar på saken" meddelande medan den jobbar med databasen. Med transaction.abort() metod kan vi ge användaren en knapp för att avbryta och rullar tillbaka.</p>

<h3>
<a id="hur-mycket-data-kan-man-lagra-i-indexeddb" class="anchor" href="#hur-mycket-data-kan-man-lagra-i-indexeddb" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hur mycket data kan man lagra i IndexedDB?</h3>

<p>Man börjar med 10MB. Om det blir större ska webbläsaren fråga användaren för tillstånd att använda mer. Oavsett tillstånd kan det aldrig vara mer än 250MB. OBS! Ingen error kommer ifall man överstiger 250MB.</p>

<h3>
<a id="hur-smidigt-är-felhanteringen" class="anchor" href="#hur-smidigt-%C3%A4r-felhanteringen" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hur smidigt är felhanteringen?</h3>

<p>Ganska smidigt. Fel bubblar upp, så man slipper hantera fel för varje request objekt, utan att man kan fixa fel till själva transaction eller databas objekt.</p>
        </section>

        <footer>
          Storage-wars is maintained by <a href="https://github.com/codinatrix">codinatrix</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>